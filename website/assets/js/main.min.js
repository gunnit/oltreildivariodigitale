class WebsiteController{constructor(){this.isDebug=!1,this.init()}init(){this.log("Initializing website..."),this.initNavigation(),this.initScrollAnimations(),this.initNewsletterForm(),this.initSmoothScrolling(),this.initImageLoading(),this.log("Website initialized successfully")}log(e){this.isDebug&&console.log(`[WebsiteController] ${e}`)}initNavigation(){const e=document.querySelector(".nav-toggle"),t=document.querySelector(".nav-menu"),i=document.querySelector(".header");e&&t&&(e.addEventListener("click",i=>{i.preventDefault(),this.toggleMobileMenu(e,t)}),document.addEventListener("click",o=>{!i.contains(o.target)&&t.classList.contains("active")&&this.closeMobileMenu(e,t)}),document.addEventListener("keydown",i=>{"Escape"===i.key&&t.classList.contains("active")&&this.closeMobileMenu(e,t)})),this.initDropdowns(),this.initHeaderScroll()}toggleMobileMenu(e,t){t.classList.toggle("active"),e.classList.toggle("active");const i=t.classList.contains("active");e.setAttribute("aria-expanded",i),document.body.style.overflow=i?"hidden":"",this.log("Mobile menu "+(i?"opened":"closed"))}closeMobileMenu(e,t){t.classList.remove("active"),e.classList.remove("active"),e.setAttribute("aria-expanded","false"),document.body.style.overflow=""}initDropdowns(){document.querySelectorAll('.nav-menu [aria-haspopup="true"]').forEach(e=>{const t=e.nextElementSibling;t&&t.classList.contains("dropdown-menu")&&(window.innerWidth>768?(e.parentElement.addEventListener("mouseenter",()=>{t.style.display="block",e.setAttribute("aria-expanded","true")}),e.parentElement.addEventListener("mouseleave",()=>{t.style.display="none",e.setAttribute("aria-expanded","false")})):e.addEventListener("click",i=>{i.preventDefault();const o="block"===t.style.display;t.style.display=o?"none":"block",e.setAttribute("aria-expanded",!o)}))})}initHeaderScroll(){const e=document.querySelector(".header");if(!e)return;let t=window.scrollY,i=!1;const o=()=>{const o=window.scrollY;o>100?e.classList.add("scrolled"):e.classList.remove("scrolled"),t=o,i=!1};window.addEventListener("scroll",()=>{i||(requestAnimationFrame(o),i=!0)})}initScrollAnimations(){const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("in-view"),e.target.classList.contains("cards-grid")&&this.animateCards(e.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),t=document.querySelectorAll(".card, .animate-on-scroll, .cards-grid");t.forEach(t=>{t.classList.add("animate-on-scroll"),e.observe(t)}),this.log(`Observing ${t.length} elements for animations`)}animateCards(e){e.querySelectorAll(".card").forEach((e,t)=>{setTimeout(()=>{e.classList.add("in-view")},150*t)})}initNewsletterForm(){document.querySelectorAll(".newsletter-form").forEach(e=>{e.addEventListener("submit",t=>{t.preventDefault(),this.handleNewsletterSubmit(e)});const t=e.querySelector('input[type="email"]');t&&(t.addEventListener("blur",()=>this.validateEmail(t)),t.addEventListener("input",()=>this.clearEmailError(t)))})}validateEmail(e){const t=e.value.trim(),i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),o=document.getElementById(`${e.id}-error`)||e.parentNode.querySelector(".error-message");return i||""===t?(e.classList.remove("error"),o&&o.classList.add("sr-only"),!0):(e.classList.add("error"),o&&(o.textContent="Inserisci un indirizzo email valido",o.classList.remove("sr-only")),!1)}clearEmailError(e){e.classList.remove("error");const t=document.getElementById(`${e.id}-error`)||e.parentNode.querySelector(".error-message");t&&t.classList.add("sr-only")}async handleNewsletterSubmit(e){const t=e.querySelector('button[type="submit"]'),i=e.querySelector('input[type="email"]');if(!this.validateEmail(i))return;const o=t.textContent;t.textContent="Iscrizione...",t.disabled=!0;try{await this.simulateNewsletterAPI(i.value),this.showNotification("Iscrizione completata con successo! ðŸŽ‰","success"),i.value=""}catch(e){this.showNotification("Errore durante l'iscrizione. Riprova piÃ¹ tardi.","error"),this.log(`Newsletter error: ${e.message}`)}finally{t.textContent=o,t.disabled=!1}}simulateNewsletterAPI(e){return new Promise((t,i)=>{setTimeout(()=>{Math.random()>.95?i(new Error("API Error")):t({success:!0,email:e})},1500)})}showNotification(e,t="info"){const i=document.querySelector(".notification");i&&i.remove();const o=document.createElement("div");o.className=`notification notification-${t}`,o.innerHTML=`\n            <div class="notification-content">\n                <span class="notification-message">${e}</span>\n                <button class="notification-close" aria-label="Chiudi notifica">&times;</button>\n            </div>\n        `,Object.assign(o.style,{position:"fixed",top:"20px",right:"20px",padding:"16px 20px",borderRadius:"8px",color:"white",fontSize:"14px",fontWeight:"500",zIndex:"10000",maxWidth:"400px",backgroundColor:"success"===t?"#10b981":"error"===t?"#ef4444":"#3b82f6",boxShadow:"0 10px 25px rgba(0,0,0,0.2)",transform:"translateX(100%)",transition:"transform 0.3s ease"}),document.body.appendChild(o),requestAnimationFrame(()=>{o.style.transform="translateX(0)"});o.querySelector(".notification-close").addEventListener("click",()=>this.hideNotification(o)),setTimeout(()=>this.hideNotification(o),5e3)}hideNotification(e){e.style.transform="translateX(100%)",setTimeout(()=>{e.parentNode&&e.remove()},300)}initSmoothScrolling(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const i=e.getAttribute("href");if("#"===i)return;const o=document.querySelector(i);o&&(t.preventDefault(),this.smoothScrollTo(o))})})}smoothScrollTo(e){const t=document.querySelector(".header")?.offsetHeight||0,i=e.offsetTop-t-20;window.scrollTo({top:i,behavior:"smooth"})}initImageLoading(){if("IntersectionObserver"in window){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const i=t.target;i.dataset.src&&(i.src=i.dataset.src,i.classList.remove("lazy"),e.unobserve(i))}})});document.querySelectorAll("img[data-src]").forEach(t=>e.observe(t))}}}let resizeTimer;document.addEventListener("DOMContentLoaded",()=>{window.websiteController=new WebsiteController}),window.addEventListener("resize",()=>{clearTimeout(resizeTimer),resizeTimer=setTimeout(()=>{window.websiteController&&window.websiteController.initDropdowns()},250)});