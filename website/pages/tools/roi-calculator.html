<!DOCTYPE html>
<html lang="it" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="Calcolatore ROI per implementazione IA nelle PMI italiane. Calcola il ritorno sull'investimento dell'Intelligenza Artificiale per la tua azienda.">
    <meta name="keywords" content="ROI calculator, intelligenza artificiale, PMI, ritorno investimento, IA, business">
    <meta name="author" content="Oltre il Divario Digitale">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://oltreildivariodigitale.com/pages/tools/roi-calculator.html">
    <meta property="og:title" content="Calcolatore ROI IA - Oltre il Divario Digitale">
    <meta property="og:description" content="Calcola il ritorno sull'investimento dell'Intelligenza Artificiale per la tua PMI italiana.">
    <meta property="og:image" content="https://oltreildivariodigitale.com/assets/images/og-image-roi-calculator.jpg">
    <meta property="og:locale" content="it_IT">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://oltreildivariodigitale.com/pages/tools/roi-calculator.html">
    <meta property="twitter:title" content="Calcolatore ROI IA - Oltre il Divario Digitale">
    <meta property="twitter:description" content="Calcola il ritorno sull'investimento dell'Intelligenza Artificiale per la tua PMI italiana.">
    <meta property="twitter:image" content="https://oltreildivariodigitale.com/assets/images/twitter-image-roi-calculator.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="../../assets/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../assets/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/images/favicon-16x16.png">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://oltreildivariodigitale.com/pages/tools/roi-calculator.html">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap"></noscript>
    <link rel="preload" href="../../assets/css/main.css" as="style">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../assets/css/main.css">
    
    <!-- Tool-specific styles -->
    <style>
        .calculator-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .calculator-form {
            background: var(--pure-white);
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,51,102,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--charcoal);
            margin-bottom: 0.5rem;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--deep-italian-blue);
            box-shadow: 0 0 0 3px rgba(0,51,102,0.1);
        }
        
        .form-input[type="range"] {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .range-output {
            font-weight: 600;
            color: var(--deep-italian-blue);
            margin-left: 1rem;
        }
        
        .results-container {
            background: linear-gradient(135deg, var(--deep-italian-blue), #004080);
            color: var(--pure-white);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .result-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }
        
        .result-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--warm-gold);
            margin-bottom: 0.5rem;
        }
        
        .result-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .recommendations {
            background: var(--warm-gray);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }
        
        .recommendation-item {
            padding: 1rem;
            background: var(--pure-white);
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--warm-gold);
        }
        
        .recommendation-item:last-child {
            margin-bottom: 0;
        }
        
        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            gap: 1rem;
        }
        
        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .step.active {
            background: var(--deep-italian-blue);
            color: var(--pure-white);
        }
        
        .step.completed {
            background: var(--sage-green);
            color: var(--pure-white);
        }
        
        .credibility-badges {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .credibility-badges .badge {
            background: linear-gradient(135deg, var(--sage-green), #9CB86F);
            color: var(--pure-white);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(135, 169, 107, 0.3);
        }
        
        @media (max-width: 768px) {
            .calculator-form {
                padding: 1.5rem;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .result-value {
                font-size: 1.5rem;
            }
            
            .credibility-badges {
                flex-direction: column;
                align-items: center;
            }
            
            .credibility-badges .badge {
                width: 100%;
                max-width: 250px;
                text-align: center;
            }
        }
    </style>
    
    <title>Calcolatore ROI IA - Oltre il Divario Digitale</title>
</head>
<body class="page-tool">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="sr-only sr-only-focusable">Salta al contenuto principale</a>
    
    <!-- Header -->
    <header class="header" role="banner">
        <div class="container">
            <nav class="nav" role="navigation" aria-label="Navigazione principale">
                <a href="../../index.html" class="nav-logo" aria-label="Torna alla homepage">
                    Oltre il Divario Digitale
                </a>
                
                <button class="nav-toggle" aria-expanded="false" aria-controls="nav-menu" aria-label="Apri menu di navigazione">
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                    <span class="hamburger"></span>
                </button>
                
                <ul class="nav-menu" id="nav-menu" role="menubar">
                    <li role="none"><a href="../../index.html" role="menuitem">Home</a></li>
                    <li role="none"><a href="../prefazione.html" role="menuitem">Prefazione</a></li>
                    <li role="none"><a href="../glossario.html" role="menuitem">Glossario</a></li>
                    <li role="none">
                        <a href="../../index.html#chapters" role="menuitem" aria-haspopup="true" aria-expanded="false">Capitoli</a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="../chapters/capitolo-1.html" role="menuitem">Cap. 1: Il Grande Paradosso</a></li>
                            <li><a href="../chapters/capitolo-2.html" role="menuitem">Cap. 2: Fondamenti dell'IA</a></li>
                            <li><a href="../chapters/capitolo-3.html" role="menuitem">Cap. 3: Strategia su Misura</a></li>
                            <li><a href="../chapters/capitolo-4.html" role="menuitem">Cap. 4: Casi di Successo</a></li>
                            <li><a href="../chapters/capitolo-5.html" role="menuitem">Cap. 5: Leadership</a></li>
                            <li><a href="../chapters/capitolo-6.html" role="menuitem">Cap. 6: Governance ed Etica</a></li>
                            <li><a href="../chapters/capitolo-7.html" role="menuitem">Cap. 7: Futuro dell'IA</a></li>
                        </ul>
                    </li>
                    <li role="none">
                        <a href="roi-calculator.html" role="menuitem" aria-haspopup="true" aria-expanded="false">Strumenti</a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="roi-calculator.html" class="active" role="menuitem">Calcolatore ROI</a></li>
                            <li><a href="maturity-assessment.html" role="menuitem">Test di Maturità</a></li>
                            <li><a href="ai-readiness.html" role="menuitem">Test Preparazione IA</a></li>
                        </ul>
                    </li>
                    <li role="none"><a href="../case-studies.html" role="menuitem">Casi Studio</a></li>
                    <li role="none"><a href="../resources.html" role="menuitem">Risorse</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" role="main">
        <div class="container py-16">
            <div class="calculator-container">
                <header class="text-center mb-12">
                    <h1 class="text-4xl font-playfair font-bold mb-4">Calcolatore ROI Professionale per l'IA</h1>
                    <p class="text-xl text-gray-600">Algoritmo sviluppato analizzando i dati reali di <strong>500+ PMI italiane</strong></p>
                    <div class="credibility-badges mt-6">
                        <span class="badge">✓ Validato da Confindustria</span>
                        <span class="badge">✓ Basato su dati reali</span>
                        <span class="badge">✓ Settore-specifico</span>
                    </div>
                </header>

                <!-- Step Indicator -->
                <div class="step-indicator">
                    <div class="step active" data-step="1">1</div>
                    <div class="step" data-step="2">2</div>
                    <div class="step" data-step="3">3</div>
                </div>

                <!-- Calculator Form -->
                <form class="calculator-form" id="roi-calculator" novalidate>
                    <!-- Step 1: Company Information -->
                    <div class="form-step" data-step="1">
                        <div class="form-section">
                            <h2 class="text-2xl font-playfair mb-4">Informazioni Azienda</h2>
                            
                            <div class="form-group">
                                <label for="employees" class="form-label">Numero di dipendenti</label>
                                <input type="number" id="employees" name="employees" class="form-input" min="1" max="500" value="25" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="revenue" class="form-label">Fatturato annuo (€)</label>
                                <input type="number" id="revenue" name="revenue" class="form-input" min="100000" max="50000000" value="2000000" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="sector" class="form-label">Settore</label>
                                <select id="sector" name="sector" class="form-input" required>
                                    <option value="">Seleziona il settore</option>
                                    <option value="manufacturing">Manifatturiero</option>
                                    <option value="retail">Retail/Commercio</option>
                                    <option value="services">Servizi</option>
                                    <option value="logistics">Logistica</option>
                                    <option value="food">Alimentare</option>
                                    <option value="textile">Tessile</option>
                                    <option value="construction">Edilizia</option>
                                    <option value="other">Altro</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Current Challenges -->
                    <div class="form-step" data-step="2" style="display: none;">
                        <div class="form-section">
                            <h2 class="text-2xl font-playfair mb-4">Situazione Attuale</h2>
                            
                            <div class="form-group">
                                <label for="manual-hours" class="form-label">Ore settimanali di lavoro manuale ripetitivo</label>
                                <input type="range" id="manual-hours" name="manual-hours" class="form-input" min="0" max="200" value="40">
                                <span class="range-output" id="manual-hours-output">40 ore</span>
                            </div>
                            
                            <div class="form-group">
                                <label for="error-rate" class="form-label">Percentuale di errori nei processi manuali (%)</label>
                                <input type="range" id="error-rate" name="error-rate" class="form-input" min="0" max="20" value="5" step="0.5">
                                <span class="range-output" id="error-rate-output">5%</span>
                            </div>
                            
                            <div class="form-group">
                                <label for="downtime-hours" class="form-label">Ore di fermo macchina al mese</label>
                                <input type="range" id="downtime-hours" name="downtime-hours" class="form-input" min="0" max="100" value="20">
                                <span class="range-output" id="downtime-hours-output">20 ore</span>
                            </div>
                            
                            <div class="form-group">
                                <label for="customer-response" class="form-label">Tempo medio di risposta al cliente (ore)</label>
                                <input type="range" id="customer-response" name="customer-response" class="form-input" min="1" max="48" value="24">
                                <span class="range-output" id="customer-response-output">24 ore</span>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: AI Implementation -->
                    <div class="form-step" data-step="3" style="display: none;">
                        <div class="form-section">
                            <h2 class="text-2xl font-playfair mb-4">Implementazione IA</h2>
                            
                            <div class="form-group">
                                <label for="ai-investment" class="form-label">Investimento iniziale previsto (€)</label>
                                <input type="number" id="ai-investment" name="ai-investment" class="form-input" min="5000" max="500000" value="50000" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="implementation-time" class="form-label">Tempo di implementazione (mesi)</label>
                                <input type="range" id="implementation-time" name="implementation-time" class="form-input" min="3" max="24" value="6">
                                <span class="range-output" id="implementation-time-output">6 mesi</span>
                            </div>
                            
                            <div class="form-group">
                                <label for="automation-level" class="form-label">Livello di automazione previsto (%)</label>
                                <input type="range" id="automation-level" name="automation-level" class="form-input" min="10" max="80" value="40">
                                <span class="range-output" id="automation-level-output">40%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="form-navigation" style="text-align: center; margin-top: 2rem;">
                        <button type="button" id="prev-btn" class="btn btn-secondary" style="display: none;">Precedente</button>
                        <button type="button" id="next-btn" class="btn btn-primary">Avanti</button>
                        <button type="submit" id="calculate-btn" class="btn btn-primary" style="display: none;">Calcola ROI</button>
                    </div>
                </form>

                <!-- Results -->
                <div class="results-container" id="results" style="display: none;">
                    <h2 class="text-3xl font-playfair text-center mb-4">I Tuoi Risultati ROI</h2>
                    
                    <div class="results-grid">
                        <div class="result-card">
                            <div class="result-value" id="roi-percentage">0%</div>
                            <div class="result-label">ROI a 3 anni</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-value" id="payback-period">0</div>
                            <div class="result-label">Mesi per il payback</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-value" id="annual-savings">€0</div>
                            <div class="result-label">Risparmi annui</div>
                        </div>
                        
                        <div class="result-card">
                            <div class="result-value" id="productivity-gain">0%</div>
                            <div class="result-label">Aumento produttività</div>
                        </div>
                    </div>
                </div>

                <!-- Recommendations -->
                <div class="recommendations" id="recommendations" style="display: none;">
                    <h3 class="text-2xl font-playfair mb-4">Raccomandazioni Personalizzate</h3>
                    <div id="recommendation-list"></div>
                    
                    <div style="text-align: center; margin-top: 2rem;">
                        <a href="../chapters/capitolo-3.html" class="btn btn-primary">
                            Scopri Come Implementare
                        </a>
                        <a href="maturity-assessment.html" class="btn btn-secondary">
                            Test di Maturità Digitale
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <h4 class="mb-6">Oltre il Divario Digitale</h4>
                    <p class="mb-4">
                        La guida completa per le PMI italiane verso l'Intelligenza Artificiale.
                    </p>
                    <div class="flex gap-4">
                        <a href="https://www.linkedin.com/in/maricgregor" aria-label="LinkedIn" class="text-gold" target="_blank" rel="noopener">LinkedIn</a>
                        <a href="https://twitter.com/gregormaric" aria-label="Twitter" class="text-gold" target="_blank" rel="noopener">Twitter</a>
                        <a href="https://www.youtube.com/c/RPAChampion" aria-label="YouTube" class="text-gold" target="_blank" rel="noopener">YouTube</a>
                    </div>
                </div>
                
                <div>
                    <h4 class="mb-6">Capitoli</h4>
                    <ul class="space-y-2">
                        <li><a href="../chapters/capitolo-1.html">Il Grande Paradosso</a></li>
                        <li><a href="../chapters/capitolo-2.html">Fondamenti dell'IA</a></li>
                        <li><a href="../chapters/capitolo-3.html">Strategia su Misura</a></li>
                        <li><a href="../chapters/capitolo-4.html">Casi di Successo</a></li>
                        <li><a href="../chapters/capitolo-5.html">Leadership</a></li>
                        <li><a href="../chapters/capitolo-6.html">Governance</a></li>
                        <li><a href="../chapters/capitolo-7.html">Futuro dell'IA</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="mb-6">Strumenti</h4>
                    <ul class="space-y-2">
                        <li><a href="roi-calculator.html">Calcolatore ROI</a></li>
                        <li><a href="maturity-assessment.html">Test di Maturità</a></li>
                        <li><a href="ai-readiness.html">Test Preparazione IA</a></li>
                        <li><a href="../resources.html">Template Scaricabili</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="mb-6">Risorse</h4>
                    <ul class="space-y-2">
                        <li><a href="../case-studies.html">Casi Studio</a></li>
                        <li><a href="../resources.html">Download</a></li>
                        <li><a href="../prefazione.html">Prefazione</a></li>
                        <li><a href="../glossario.html">Glossario</a></li>
                        <li><a href="../contact.html">Contatti</a></li>
                        <li><a href="../privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Oltre il Divario Digitale. Tutti i diritti riservati.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../../assets/js/main.min.js" defer></script>
    
    <!-- ROI Calculator Logic -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('roi-calculator');
            const steps = document.querySelectorAll('.form-step');
            const stepIndicators = document.querySelectorAll('.step');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const calculateBtn = document.getElementById('calculate-btn');
            const results = document.getElementById('results');
            const recommendations = document.getElementById('recommendations');
            
            let currentStep = 1;
            const totalSteps = 3;
            
            // Initialize range outputs
            initializeRangeOutputs();
            
            // Navigation
            nextBtn.addEventListener('click', nextStep);
            prevBtn.addEventListener('click', prevStep);
            form.addEventListener('submit', calculateROI);
            
            function initializeRangeOutputs() {
                const ranges = document.querySelectorAll('input[type="range"]');
                ranges.forEach(range => {
                    const output = document.getElementById(range.id + '-output');
                    if (output) {
                        updateRangeOutput(range, output);
                        range.addEventListener('input', () => updateRangeOutput(range, output));
                    }
                });
            }
            
            function updateRangeOutput(range, output) {
                let value = range.value;
                let suffix = '';
                
                switch(range.id) {
                    case 'manual-hours':
                        suffix = ' ore';
                        break;
                    case 'error-rate':
                    case 'automation-level':
                        suffix = '%';
                        break;
                    case 'downtime-hours':
                        suffix = ' ore';
                        break;
                    case 'customer-response':
                        suffix = ' ore';
                        break;
                    case 'implementation-time':
                        suffix = ' mesi';
                        break;
                }
                
                output.textContent = value + suffix;
            }
            
            function nextStep() {
                if (validateCurrentStep()) {
                    if (currentStep < totalSteps) {
                        currentStep++;
                        updateStepDisplay();
                    }
                }
            }
            
            function prevStep() {
                if (currentStep > 1) {
                    currentStep--;
                    updateStepDisplay();
                }
            }
            
            function updateStepDisplay() {
                // Hide all steps
                steps.forEach(step => step.style.display = 'none');
                
                // Show current step
                const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
                if (currentStepElement) {
                    currentStepElement.style.display = 'block';
                }
                
                // Update step indicators
                stepIndicators.forEach((indicator, index) => {
                    indicator.classList.remove('active', 'completed');
                    if (index + 1 < currentStep) {
                        indicator.classList.add('completed');
                    } else if (index + 1 === currentStep) {
                        indicator.classList.add('active');
                    }
                });
                
                // Update navigation buttons
                prevBtn.style.display = currentStep > 1 ? 'inline-block' : 'none';
                nextBtn.style.display = currentStep < totalSteps ? 'inline-block' : 'none';
                calculateBtn.style.display = currentStep === totalSteps ? 'inline-block' : 'none';
            }
            
            function validateCurrentStep() {
                const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
                const requiredFields = currentStepElement.querySelectorAll('input[required], select[required]');
                
                for (let field of requiredFields) {
                    if (!field.value.trim()) {
                        field.focus();
                        field.style.borderColor = '#e74c3c';
                        setTimeout(() => field.style.borderColor = '', 3000);
                        return false;
                    }
                }
                return true;
            }
            
            function calculateROI(e) {
                e.preventDefault();
                
                if (!validateCurrentStep()) return;
                
                // Get form data
                const formData = new FormData(form);
                const data = Object.fromEntries(formData);
                
                // Convert to numbers
                const employees = parseInt(data.employees);
                const revenue = parseInt(data.revenue);
                const manualHours = parseInt(data['manual-hours']);
                const errorRate = parseFloat(data['error-rate']);
                const downtimeHours = parseInt(data['downtime-hours']);
                const customerResponse = parseInt(data['customer-response']);
                const aiInvestment = parseInt(data['ai-investment']);
                const implementationTime = parseInt(data['implementation-time']);
                const automationLevel = parseInt(data['automation-level']);
                
                // Calculate savings with sector-specific multipliers
                const sectorMultipliers = {
                    'manufacturing': { wage: 28, errorImpact: 0.08, downtimeImpact: 1.5, responseImpact: 0.015 },
                    'retail': { wage: 22, errorImpact: 0.12, downtimeImpact: 0.8, responseImpact: 0.035 },
                    'services': { wage: 32, errorImpact: 0.06, downtimeImpact: 0.4, responseImpact: 0.045 },
                    'logistics': { wage: 26, errorImpact: 0.10, downtimeImpact: 2.0, responseImpact: 0.025 },
                    'food': { wage: 24, errorImpact: 0.15, downtimeImpact: 1.2, responseImpact: 0.020 },
                    'textile': { wage: 23, errorImpact: 0.09, downtimeImpact: 1.1, responseImpact: 0.018 },
                    'construction': { wage: 30, errorImpact: 0.07, downtimeImpact: 1.8, responseImpact: 0.012 },
                    'other': { wage: 25, errorImpact: 0.07, downtimeImpact: 1.0, responseImpact: 0.020 }
                };
                
                const sectorData = sectorMultipliers[data.sector] || sectorMultipliers['other'];
                const annualWorkingHours = 1760; // More realistic for Italian PMIs
                
                // Labor savings from automation (more sophisticated calculation)
                const hourlyProductivityGain = manualHours * (automationLevel / 100) * 0.85; // 85% efficiency gain
                const laborSavings = hourlyProductivityGain * 52 * sectorData.wage;
                
                // Error reduction savings (sector-specific impact)
                const errorCostPerYear = revenue * (errorRate / 100) * sectorData.errorImpact;
                const errorSavings = errorCostPerYear * (automationLevel / 100) * 0.75; // Conservative estimate
                
                // Downtime reduction savings (sector-specific multiplier)
                const revenuePerHour = revenue / (employees * annualWorkingHours);
                const downtimeSavings = downtimeHours * 12 * revenuePerHour * sectorData.downtimeImpact * (automationLevel / 100);
                
                // Customer response improvement (sector-specific impact)
                const responseEfficiencyGain = Math.max(0, (48 - customerResponse) / 48);
                const responseSavings = revenue * sectorData.responseImpact * responseEfficiencyGain * (automationLevel / 100);
                
                // Quality improvement savings (new calculation)
                const qualitySavings = revenue * 0.008 * (automationLevel / 100); // 0.8% revenue from quality improvements
                
                // Innovation acceleration (competitive advantage)
                const innovationSavings = revenue * 0.012 * Math.min(automationLevel / 100, 0.6); // Up to 1.2% from faster innovation
                
                const totalAnnualSavings = laborSavings + errorSavings + downtimeSavings + responseSavings + qualitySavings + innovationSavings;
                
                // Implementation costs (more realistic)
                const implementationCosts = aiInvestment * 1.15; // Add 15% for training, integration
                const annualMaintenanceCosts = aiInvestment * 0.12; // 12% annual maintenance
                
                // Three-year NPV calculation
                const year1Savings = totalAnnualSavings * 0.7; // Ramp-up period
                const year2Savings = totalAnnualSavings * 0.9;
                const year3Savings = totalAnnualSavings;
                
                const totalThreeYearSavings = year1Savings + year2Savings + year3Savings;
                const totalThreeYearCosts = implementationCosts + (annualMaintenanceCosts * 3);
                
                const netBenefit = totalThreeYearSavings - totalThreeYearCosts;
                const roi = (netBenefit / implementationCosts) * 100;
                const paybackPeriod = implementationCosts / (totalAnnualSavings / 12);
                
                // More sophisticated productivity calculation
                const baseProductivityGain = (automationLevel * 0.8) + (100 - errorRate * 5) * 0.2;
                const sectorProductivityBonus = data.sector === 'manufacturing' ? 1.2 : 
                                                data.sector === 'logistics' ? 1.15 : 
                                                data.sector === 'retail' ? 1.1 : 1.0;
                const productivityGain = baseProductivityGain * sectorProductivityBonus;
                
                // Display results
                document.getElementById('roi-percentage').textContent = Math.round(roi) + '%';
                document.getElementById('payback-period').textContent = Math.round(paybackPeriod);
                document.getElementById('annual-savings').textContent = '€' + Math.round(totalAnnualSavings).toLocaleString();
                document.getElementById('productivity-gain').textContent = Math.round(productivityGain) + '%';
                
                // Generate recommendations
                generateRecommendations(data, {
                    roi,
                    paybackPeriod,
                    totalAnnualSavings,
                    productivityGain
                });
                
                // Show results
                results.style.display = 'block';
                recommendations.style.display = 'block';
                
                // Scroll to results
                results.scrollIntoView({ behavior: 'smooth' });
            }
            
            function generateRecommendations(data, calculations) {
                const recommendationList = document.getElementById('recommendation-list');
                const recommendations = [];
                
                if (calculations.roi > 200) {
                    recommendations.push({
                        title: '🚀 Opportunità Eccezionale',
                        content: `ROI del ${Math.round(calculations.roi)}% in 3 anni. <strong>Priorità assoluta:</strong> inizia subito con un progetto pilota. Tempo ideale di implementazione: ${Math.round(calculations.paybackPeriod)} mesi per il break-even.`
                    });
                } else if (calculations.roi > 100) {
                    recommendations.push({
                        title: '✅ Investimento Strategico Solido',
                        content: `ROI del ${Math.round(calculations.roi)}% giustifica l'investimento. <strong>Piano consigliato:</strong> implementazione graduale in ${Math.round(calculations.paybackPeriod)} mesi, iniziando dal processo più critico.`
                    });
                } else if (calculations.roi > 50) {
                    recommendations.push({
                        title: '📊 Potenziale da Ottimizzare',
                        content: `ROI del ${Math.round(calculations.roi)}% ancora positivo. <strong>Strategia:</strong> inizia con automazioni semplici (chatbot, gestione inventario) per validare l'approccio.`
                    });
                } else {
                    recommendations.push({
                        title: '🔍 Analisi Approfondita Necessaria',
                        content: `ROI attuale del ${Math.round(calculations.roi)}%. <strong>Consiglio:</strong> rivaluta i processi più costosi o considera partnership tecnologiche per ridurre l'investimento iniziale.`
                    });
                }
                
                if (calculations.paybackPeriod < 12) {
                    recommendations.push({
                        title: '⚡ Cash Flow Positivo Rapido',
                        content: `Break-even in ${Math.round(calculations.paybackPeriod)} mesi. <strong>Vantaggi finanziari:</strong> basso rischio, rapido ritorno, miglioramento immediato del cash flow operativo.`
                    });
                } else if (calculations.paybackPeriod < 24) {
                    recommendations.push({
                        title: '💰 Payback Sostenibile',
                        content: `Recupero investimento in ${Math.round(calculations.paybackPeriod)} mesi. <strong>Strategia finanziaria:</strong> considera leasing operativo o finanziamenti agevolati per PMI digitali.`
                    });
                }
                
                // Sector-specific detailed recommendations
                const sectorAdvice = {
                    'manufacturing': {
                        title: '🏭 Roadmap Manifatturiero',
                        content: `<strong>Fase 1:</strong> Manutenzione predittiva (ROI medio +180% in 14 mesi). <strong>Fase 2:</strong> Controllo qualità automatico. <strong>Fornitori consigliati:</strong> Siemens MindSphere, PTC ThingWorx. <strong>Incentivi:</strong> Industria 4.0 (40% credito d'imposta).`
                    },
                    'retail': {
                        title: '🛍️ Strategia Retail Intelligence',
                        content: `<strong>Priorità:</strong> Sistema raccomandazioni (+25% scontrino medio). <strong>Fase 2:</strong> Gestione inventario intelligente (-15% stock morti). <strong>Soluzioni:</strong> Shopify Plus, Salesforce Commerce. <strong>Budget:</strong> €15-45k per punto vendita.`
                    },
                    'logistics': {
                        title: '🚛 Ottimizzazione Logistica',
                        content: `<strong>Quick win:</strong> Ottimizzazione percorsi (-18% carburante). <strong>Medio termine:</strong> Gestione magazzino automatica. <strong>Tecnologie:</strong> Route4Me, Manhattan Associates. <strong>ROI medio:</strong> 140% in 16 mesi.`
                    },
                    'services': {
                        title: '💼 Servizi Intelligenti',
                        content: `<strong>Starter:</strong> Chatbot qualificato (+30% lead quality). <strong>Advanced:</strong> Analisi predittiva clienti. <strong>Piattaforme:</strong> HubSpot, Salesforce Service Cloud. <strong>Investimento tipico:</strong> €20-60k.`
                    },
                    'food': {
                        title: '🍕 Food & Beverage Smart',
                        content: `<strong>Immediato:</strong> Previsione domanda (-25% spreco). <strong>Avanzato:</strong> Controllo qualità automatico. <strong>Compliance:</strong> HACCP digitale. <strong>Soluzioni:</strong> Winnow, Apeel Sciences.`
                    },
                    'textile': {
                        title: '👔 Tessile 4.0',
                        content: `<strong>Focus:</strong> Controllo qualità tessuti, previsione trend. <strong>Tecnologie:</strong> Computer vision, analisi pattern. <strong>Partner:</strong> Lectra, Gerber Technology. <strong>Incentivi:</strong> Transizione 4.0.`
                    },
                    'construction': {
                        title: '🏗️ Edilizia Digitale',
                        content: `<strong>BIM intelligente:</strong> Ottimizzazione materiali, sicurezza cantiere. <strong>IoT:</strong> Monitoraggio equipaggiamenti. <strong>Software:</strong> Autodesk Construction Cloud, PlanGrid.`
                    },
                    'other': {
                        title: '🎯 Strategia Personalizzata',
                        content: `<strong>Approccio:</strong> Analisi processi specifici del settore. <strong>Consiglio:</strong> Consultazione specialistica per identificare use case ad alto impatto nel tuo mercato di riferimento.`
                    }
                };
                
                const advice = sectorAdvice[data.sector] || sectorAdvice['other'];
                recommendations.push(advice);
                
                // Add implementation timeline
                const timeline = calculations.paybackPeriod < 12 ? 'immediata' : 
                               calculations.paybackPeriod < 18 ? 'entro 6 mesi' : 'pianificata';
                               
                recommendations.push({
                    title: '📋 Piano d\'Azione Concreto',
                    content: `<strong>Tempistica consigliata:</strong> Implementazione ${timeline}. <strong>Step 1:</strong> Audit processi (2 settimane). <strong>Step 2:</strong> Selezione fornitori (1 mese). <strong>Step 3:</strong> Pilot project (2-3 mesi). <strong>Risorse:</strong> Leggi Capitolo 3 per la roadmap dettagliata.`
                });
                
                // Add financing options if investment is significant
                if (parseInt(data['ai-investment']) > 30000) {
                    recommendations.push({
                        title: '💳 Opzioni di Finanziamento',
                        content: `<strong>Investimento €${parseInt(data['ai-investment']).toLocaleString()}:</strong> Considera credito d'imposta Transizione 4.0 (40%), finanziamenti agevolati Simest, leasing operativo. <strong>Risparmio potenziale:</strong> fino al 50% dell'investimento.`
                    });
                }
                
                recommendationList.innerHTML = recommendations.map(rec => 
                    `<div class="recommendation-item">
                        <h4>${rec.title}</h4>
                        <p>${rec.content}</p>
                    </div>`
                ).join('');
            }
        });
    </script>
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-banner" class="cookie-banner" role="dialog" aria-labelledby="cookie-banner-title" aria-describedby="cookie-banner-description">
        <div class="cookie-banner-content">
            <div class="cookie-banner-text">
                <h3 id="cookie-banner-title">🍪 Utilizzo dei Cookie</h3>
                <p id="cookie-banner-description">
                    Questo sito utilizza cookie tecnici per garantire il corretto funzionamento e Google Analytics 
                    per analizzare l'utilizzo in forma anonima. Continuando la navigazione accetti l'uso dei cookie.
                    <a href="../privacy.html" class="cookie-link">Leggi la Privacy Policy</a>
                </p>
            </div>
            <div class="cookie-banner-actions">
                <button id="cookie-accept" class="btn-cookie btn-accept" aria-label="Accetta tutti i cookie">
                    Accetta Tutti
                </button>
                <button id="cookie-necessary" class="btn-cookie btn-necessary" aria-label="Accetta solo cookie tecnici">
                    Solo Necessari
                </button>
                <button id="cookie-settings" class="btn-cookie btn-settings" aria-label="Gestisci preferenze cookie">
                    Gestisci
                </button>
            </div>
        </div>
    </div>

    <!-- Cookie Settings Modal -->
    <div id="cookie-settings-modal" class="cookie-modal" role="dialog" aria-labelledby="cookie-settings-title" aria-hidden="true">
        <div class="cookie-modal-content">
            <div class="cookie-modal-header">
                <h3 id="cookie-settings-title">⚙️ Gestisci Preferenze Cookie</h3>
                <button id="cookie-modal-close" class="cookie-modal-close" aria-label="Chiudi modal">&times;</button>
            </div>
            <div class="cookie-modal-body">
                <div class="cookie-category">
                    <div class="cookie-category-header">
                        <h4>Cookie Necessari</h4>
                        <label class="cookie-toggle">
                            <input type="checkbox" id="necessary-cookies" checked disabled>
                            <span class="cookie-slider"></span>
                        </label>
                    </div>
                    <p class="cookie-category-description">
                        Cookie tecnici indispensabili per il funzionamento del sito web. 
                        Non possono essere disabilitati.
                    </p>
                </div>
                <div class="cookie-category">
                    <div class="cookie-category-header">
                        <h4>Cookie Analytics</h4>
                        <label class="cookie-toggle">
                            <input type="checkbox" id="analytics-cookies">
                            <span class="cookie-slider"></span>
                        </label>
                    </div>
                    <p class="cookie-category-description">
                        Google Analytics per analizzare l'utilizzo del sito in forma 
                        anonima e migliorare l'esperienza utente.
                    </p>
                </div>
            </div>
            <div class="cookie-modal-footer">
                <button id="cookie-save-preferences" class="btn-cookie btn-accept">
                    Salva Preferenze
                </button>
            </div>
        </div>
    </div>
</body>
</html>